let config={rootPath:""};const buildConfigRootPath=async()=>{const t=require("fs-extra");await(async()=>{let e=await t.readJson(`${__dirname}/package.json`);config.rootPath=e.homepage,config.rootPath.endsWith("/")&&(config.rootPath=config.rootPath.substring(0,config.rootPath.length-1))})().catch(t=>console.log(t))},buildRoutes=async()=>{const t=require("fs-extra"),e=require("fast-glob"),o=require("replaceall");await(async()=>{try{const n=(await e("src/pages/**/{Index.{tsx,jsx},[[]*.{tsx,jsx}}")).map(t=>{let e=t.replace("src/pages/","");t=e.endsWith(".tsx")?e.substring(0,e.length-4):e,e.endsWith("Index.tsx")&&(e=e.substring(0,e.length-10)),e.endsWith(".tsx")&&(e=e.substring(0,e.length-4)),e=o("[...","*",e),e=o("[",":",e),e=o("]","",e);for(const t of e)if("*"===t){const o=e.substring(e.indexOf(t));o.substring(1,o.indexOf("/")),e=e.replace(o,"")}return e.endsWith("/")||(e+="/"),e.startsWith("/")||(e=`/${e}`),e.toLowerCase(),{path:e,component:`./pages/${t}`}});let a=await t.readFile(`${__dirname}/src/Router.tsx`);const s=(a=a.toString()).substring(a.indexOf("// routes-begin"),a.indexOf("// routes-end"));let i="// routes-begin\n// AUTO-GENERATED SECTION - DO NOT EDIT";if(n.length>0){for(const t of n)i+=`\nimport page${n.indexOf(t)} from "${t.component}";`;i+="\nconst routes = [ ";for(const t of n){const e=n.indexOf(t);i+=`{ path: "${t.path}", component: page${e} }, `}i=i.substring(0,i.length-2),i+=" ];",i+="\n"}else i+="\nconst routes = null;\n";i+=`const appBasename = "${config.rootPath}";\nexport { appBasename };\n`;const r=o(s,i,a);await t.writeFile(`${__dirname}/src/Router.tsx`,r)}catch(t){console.log(t)}})().catch(t=>console.log(t))},buildStaticNotFoundPage=async()=>{const t=require("fs-extra"),e=require("replaceall");await(async()=>{let o={};config.rootPath.startsWith("/")?o.rootPath=config.rootPath.substring(1):o.rootPath=config.rootPath;let n=o.rootPath.split("/").length;""===o.rootPath.split("/")[o.rootPath.split("/").length-1]&&n--;let a=await t.readFile(`${__dirname}/public/404.html`);const s=(a=a.toString()).substring(a.indexOf("// path-begin"),a.indexOf("// path-end"));let i="// path-begin\n    // AUTO-GENERATED SECTION - DO NOT EDIT\n";const r=e(s,i+=`    var pathSegmentsToKeep = ${n};\n    `,a);await t.writeFile(`${__dirname}/public/404.html`,r)})().catch(t=>console.log(t))},runScripts=async()=>{await buildConfigRootPath(),await buildRoutes(),await buildStaticNotFoundPage()};console.log("Defining routes..."),runScripts().then(console.log("Routes defined!")).catch(t=>console.log(t));